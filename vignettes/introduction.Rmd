---
title: "Introduction to inkaR"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to inkaR}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
    collapse = TRUE,
    comment = "#>"
)
```

## Overview

The `inkaR` package provides a modern, user-friendly interface to access statistical data from the [BBSR INKAR](https://www.inkar.de/) database (Indikatoren und Karten zur Raum- und Stadtentwicklung). 

Key features include:
- **Easy Data Access**: Download data using simple IDs or short codes.
- **Bilingual Support**: Work with metadata in German (default) or English.
- **Offline Search**: Quickly find indicators without needing to query the API repeatedly.
- **Direct Export**: Save data directly to CSV files matching your workflow.

## Installation

You can install the package from your local source or GitHub:

```r
# If installing from local source
devtools::install()
library(inkaR)
```

## 1. Finding Indicators

The INKAR database contains hundreds of indicators. `inkaR` provides tools to find what you need.

### List All Indicators

To see a sortable, searchable list of all available indicators:

```r
# Opens a viewer in RStudio
view_indicators()

# View English metadata
view_indicators(lang = "en")
```

### Search by Text

If you are looking for a specific topic, like "GDP" or "Population":

```r
# Search in English names/descriptions
search_indicators("GDP", lang = "en")

# Search in German (default)
search_indicators("Arbeitslosigkeit")
```

The search results includes the `ID` (Shortname) and `M_ID` which you will need to download data.

## 2. Downloading Data

Use `get_inkar_data()` to fetch statistics. You need:
1. **variable**: The indicator ID (e.g., "011" for GDP).
2. **level**: The spatial level (e.g., "KRE" for Districts/Kreise).

### Basic Download

```r
# Download GDP (011) for Districts (KRE) for the latest available year
df <- get_inkar_data("011", level = "KRE")
head(df)
```

### Specifying Years

You can request a specific year or a range of years:

```r
# Single year
df_2021 <- get_inkar_data("011", level = "KRE", year = 2021)

# Year range
df_range <- get_inkar_data("011", level = "KRE", year = 2015:2020)
```

### Bilingual Output

By default, column names are in German (matching the original source). You can switch to English:

```r
df_en <- get_inkar_data("011", level = "KRE", lang = "en")
# Columns: region_id, region_name, indicator_name, year, value
```

## 3. Exporting Data

You can save the retrieved data directly to a CSV file. The filename is automatically generated based on the indicator name, level, and timestamp.

```r
# Download and save immediately
get_inkar_data("011", level = "KRE", csv = TRUE)

# Output: Data saved to: inkar_011_KRE_Bruttoinlandsprodukt_....csv
```

## Reference: Spatial Levels

Common spatial levels include:
- `KRE`: Districts (Kreise / Kreisfreie Städte)
- `GEM`: Municipalities (Gemeinden)
- `ROR`: Spatial Planning Regions (Raumordnungsregionen)
- `BLD`: Federal States (Bundesländer)
- `BND`: Federal Territory (Bund)

Use `get_geographies()` to see all available levels.
